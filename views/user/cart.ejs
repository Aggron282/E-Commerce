
<%- include("./../layouts/user/head.ejs") %>

<%- include("./../layouts/user/home/header.ejs") %>

  <div class="black_overlay"></div>

  <main class="cart_interface container-fluid">

    <div class="overlay_content inactive">
      <%- include("./../layouts/user/home/search_overlay.ejs") %>
    </div>

    <div class="profile_change_overlay">
      <%- include("./../layouts/modal/profile.ejs") %>
      <%- include("./../layouts/modal/update_location.ejs") %>
    </div>

    <div class="cart_interface_container main_content padding-5 ">

      <p class="cart_interface_heading width-100"> Your Cart</p>

      <div class="row relative">

        <div class="col-8 cart_interface_col--items">

            <% if (items) {%>

                <% if (items.length > 0) {%>

                    <% for (var i = 0; i < items.length; i++) { %>
                      <div class="cart_interface_box">

                        <div class="row">

                          <div class="col-4">
                            <img class="margin-left-25 cart_interface_product--img" src =   <%= `/${items[i].data.thumbnail}` %> />
                          </div>

                          <div class="col-6">

                            <p class="cart_interface--title cart_interface--text width-100"> <%= items[i].data.title %> </p>
                            <p class="cart_interface--title cart_interface--text width-100"> $<%= items[i].data.price %>.99 </p>
                            <p class="cart_interface--title cart_interface--text width-100"> Qty: <%= items[i].data.quantity %> </p>

                            <form method = "POST" action = "/cart/delete" >
                              <input  type="hidden" name = "_id" value= <%= items[i].data._id %> />
                              <button class="cart_interface_button--delete" type="submit"> Delete </button>
                            </form>

                          </div>


                        </div>

                      </div>

                    <% }%>

                <% } %>

            <% } %>

        </div>

        <div class="col-3 relative">

            <div class="cart_interface_total_price_container">

                <p class="cart_interface_heading">Total Price</p>
                <p class="cart_interface_total">$ <%= total_price %> .99</p>
                <button class="cart_interface_button--checkout" id="order_button"> Buy Now</button>

                <script src="https://js.stripe.com/v3/"></script>

            </div>

        </div>

      </div>

    </div>

  </main>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

<script src="./js/slideshow.js"></script>
<script src = "./js/cart.js" ></script>
<script src = "./js/util.js" ></script>
<script src="./js/search_results.js"></script>
<script src = "./js/catagory_render.js" ></script>
<script src = "./../js/catagory_toggle.js" ></script>
<script src = "./../js/search_results.js" ></script>
<script src = "./../js/edit_profile.js" ></script>
<script src = "./../js/update_location.js" ></script>

<script>

  var stripe = Stripe("pk_test_51OjAfEL9aEOLpUqjiSrhltnG3aHmrvWEppeBUnNx9OR1oXRGA4GaLJEaU3Z1fKEXd89z0uZhd04ONLoB3NQpdTmt00u5Ujogny")
  var order_button = document.getElementById("order_button");

  order_button.addEventListener("click",(e)=>{
      stripe.redirectToCheckout({
        sessionId:"<%= session_id %>",

      })
  });

</script>

<script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyACepJIoDZ1rhhju2bK-lO23qIzaKwXsnY&loading=async&libraries=maps,marker&v=beta" defer>
</script>

<%- include("./../layouts/end.ejs") %>
